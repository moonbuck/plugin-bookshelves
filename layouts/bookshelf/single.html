{{- define "main" }}
{{- /* Wrap the content */}}
<section id="wrapper">
<article class="h-entry post">
<section class="e-content post-body">

{{- $initial_view := site.Data.plugin_bookshelves_data.InitialView | default site.Params.bookshelves_initial_view -}}

{{- /* Create the list-grid layout buttons */}}
<div id="bookshelves-button-container-wrapper"><div id="bookshelves-button-container">
<button id="list-view" class="button{{ if not (and $initial_view (eq "grid" $initial_view)) }} active{{ end }}" onclick="listView()"><svg class="svg-inline--fa fa-list" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="list" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M80 48h-64C7.156 48 0 55.16 0 64v64c0 8.844 7.156 16 16 16h64C88.84 144 96 136.8 96 128V64C96 55.16 88.84 48 80 48zM80 208h-64C7.156 208 0 215.2 0 224v64c0 8.844 7.156 16 16 16h64C88.84 304 96 296.8 96 288V224C96 215.2 88.84 208 80 208zM80 368h-64C7.156 368 0 375.2 0 384v64c0 8.844 7.156 16 16 16h64C88.84 464 96 456.8 96 448v-64C96 375.2 88.84 368 80 368zM192 128h288c17.67 0 32-14.33 32-31.1S497.7 64 480 64H192C174.3 64 160 78.33 160 95.1S174.3 128 192 128zM480 384H192c-17.67 0-32 14.33-32 32s14.33 32 32 32h288c17.67 0 32-14.33 32-32S497.7 384 480 384zM480 224H192C174.3 224 160 238.3 160 256s14.33 32 32 32h288c17.67 0 32-14.33 32-32S497.7 224 480 224z"></path></svg><!-- <i class="fas fa-list"></i> --><span class="button-text"> List</span></button> 
<button id="grid-view" class="button{{ if (and $initial_view (eq "grid" $initial_view)) }} active{{ end }}" onclick="gridView()"><svg class="svg-inline--fa fa-th" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="th" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M448 32H64C28.65 32 0 60.65 0 96v320c0 35.35 28.65 64 64 64h384c35.35 0 64-28.65 64-64V96C512 60.65 483.3 32 448 32zM298.7 96v64H213.3V96H298.7zM298.7 224v64H213.3V224H298.7zM64 96h85.33v64H64V96zM64 224h85.33v64H64V224zM64 416v-64h85.33v64H64zM213.3 416v-64h85.33v64H213.3zM448 416h-85.33v-64H448V416zM448 288h-85.33V224H448V288zM448 160h-85.33V96H448V160z"></path></svg><!-- <i class="fas fa-th"></i> --><span class="button-text"> Grid</span></button>
</div></div>

{{- /* Check for bookshelves data */}}
{{- $bookshelves_data := false }}
{{- with (site.Data.plugin_bookshelves_data | default site.Data.plugin_bookshelves.bookshelves_data) }}
{{- $bookshelves_data = . }}
{{- else }}
{{- with site.Params.bookshelves_data }}{{ $bookshelves_data = . }}{{ end }}
{{- end }}

{{- /* Unmarshall the data if we found it in string form */}}
{{- if (and $bookshelves_data (not ($bookshelves_data | reflect.IsMap))) }}
{{- with transform.Unmarshal $bookshelves_data }}
{{- $bookshelves_data = . }}
{{- end }}
{{- end }}

{{- with $bookshelves_data }}

{{- partial "bookshelves-from-data.html" . }}

{{- else }}
  
{{- partial "bookshelves-inferred.html" . }}

{{- end }}

</section>
</article>
</section>

{{- end }}
